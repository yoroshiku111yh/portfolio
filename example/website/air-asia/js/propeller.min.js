/*!
 *                          . .
 *                          | |            o
 *      ;-. ;-. ,-. ;-. ,-. | | ,-. ;-.    , ,-.
 *      | | |   | | | | |-' | | |-' |      | `-.
 *      |-' '   `-' |-' `-' ' ' `-' '   o  | `-'
 *      '           '                     -'
 *
 *      http://pixelscommander.com/polygon/propeller/example/
 *      jQuery plugin to rotate HTML elements by mouse. With inertia or without it.
 *
 *      Copyright (c) 2014 Denis Radin
 *      Licensed under the MIT license.
 *
 *      Title generated using "speed" http://patorjk.com/software/taag/#p=display&f=Shimrod&t=propeller.js
 *      Inspired by Brian Gonzalez
 */
;(function(a){var b="propeller";var d={angle:0,speed:0,inertia:0,minimalSpeed:0.001,minimalAngleChange:0.1,step:0,stepTransitionTime:0,stepTransitionEasing:"linear",rotateParentInstantly:false,touchElement:null};var f=function(h,g){if(typeof h==="string"){h=document.querySelectorAll(h)}if(h.length>1){return f.createMany(h,g)}else{if(h.length===1){h=h[0]}}this.element=h;this.active=false;this.transiting=false;this.update=this.update.bind(this);this.initCSSPrefix();this.initAngleGetterSetter();this.initOptions(g);this.initHardwareAcceleration();this.initTransition();this.bindHandlers();this.addListeners();this.update()};f.createMany=function(h,j){var g=[];for(var k=0;k<h.length;k++){g.push(new f(h[k],j))}return g};var c=f.prototype;c.initAngleGetterSetter=function(){getterSetter(this,"angle",function(){return this._angle},function(g){this._angle=g;this.virtualAngle=g;this.updateCSS()})};c.bindHandlers=function(){this.onRotationStart=this.onRotationStart.bind(this);this.onRotationStop=this.onRotationStop.bind(this);this.onRotated=this.onRotated.bind(this)};c.addListeners=function(){this.listenersInstalled=true;if("ontouchstart" in document.documentElement){this.touchElement.addEventListener("touchstart",this.onRotationStart);this.touchElement.addEventListener("touchmove",this.onRotated);this.touchElement.addEventListener("touchend",this.onRotationStop);this.touchElement.addEventListener("touchcancel",this.onRotationStop);this.touchElement.addEventListener("dragstart",this.returnFalse)}else{this.touchElement.addEventListener("mousedown",this.onRotationStart);this.touchElement.addEventListener("mousemove",this.onRotated);this.touchElement.addEventListener("mouseup",this.onRotationStop);this.touchElement.addEventListener("mouseleave",this.onRotationStop);this.touchElement.addEventListener("dragstart",this.returnFalse)}this.touchElement.ondragstart=this.returnFalse};c.removeListeners=function(){this.listenersInstalled=false;if("ontouchstart" in document.documentElement){this.touchElement.removeEventListener("touchstart",this.onRotationStart);this.touchElement.removeEventListener("touchmove",this.onRotated);this.touchElement.removeEventListener("touchend",this.onRotationStop);this.touchElement.removeEventListener("touchcancel",this.onRotationStop);this.touchElement.removeEventListener("dragstart",this.returnFalse)}else{this.touchElement.removeEventListener("mousedown",this.onRotationStart);this.touchElement.removeEventListener("mousemove",this.onRotated);this.touchElement.removeEventListener("mouseup",this.onRotationStop);this.touchElement.removeEventListener("mouseleave",this.onRotationStop);this.touchElement.removeEventListener("dragstart",this.returnFalse)}};c.bind=function(){if(this.listenersInstalled!==true){this.addListeners()}};c.unbind=function(){if(this.listenersInstalled===true){this.removeListeners();this.onRotationStop()}};c.stop=function(){this.speed=0;this.onRotationStop()};c.onRotationStart=function(g){this.initCoordinates();this.initDrag();this.active=true;if(this.onDragStart!==undefined){this.onDragStart()}if(this.rotateParentInstantly===false){g.stopPropagation()}};c.onRotationStop=function(){if(this.onDragStop!==undefined&&this.active===true){this.onDragStop()}this.active=false};c.onRotated=function(g){if(this.active===true){g.stopPropagation();g.preventDefault();if(g.targetTouches!==undefined&&g.targetTouches[0]!==undefined){this.lastMouseEvent={pageX:g.targetTouches[0].pageX,pageY:g.targetTouches[0].pageY}}else{this.lastMouseEvent={pageX:g.pageX||g.clientX,pageY:g.pageY||g.clientY}}}};c.update=function(){if(this.lastMouseEvent!==undefined&&this.active===true){this.updateAngleToMouse(this.lastMouseEvent)}this.updateAngle();this.applySpeed();this.applyInertia();if(Math.abs(this.lastAppliedAngle-this._angle)>=this.minimalAngleChange&&this.transiting===false){this.updateCSS();this.blockTransition();if(this.onRotate!==undefined&&typeof this.onRotate==="function"){this.onRotate.bind(this)()}this.lastAppliedAngle=this._angle}window.requestAnimFrame(this.update)};c.updateAngle=function(){if(this.step>0){this._angle=this.getAngleFromVirtual()}else{this._angle=this.normalizeAngle(this.virtualAngle)}};c.getAngleFromVirtual=function(){return Math.ceil(this.virtualAngle/this.step)*this.step};c.normalizeAngle=function(h){var g=h;g=g%360;if(g<0){g=360+g}return g};c.differenceBetweenAngles=function(l,i){var h=l*(Math.PI/180);var g=i*(Math.PI/180);var j=Math.atan2(Math.sin(h-g),Math.cos(h-g));var k=j*(180/Math.PI);return Math.round(k*100)/100};c.applySpeed=function(){if(this.inertia>0&&this.speed!==0&&this.active===false){this.virtualAngle+=this.speed}};c.applyInertia=function(){if(this.inertia>0){if(Math.abs(this.speed)>=this.minimalSpeed){this.speed=this.speed*this.inertia;if(this.active===false&&Math.abs(this.speed)<this.minimalSpeed){if(this.onStop!==undefined){this.onStop()}}}else{if(this.speed!==0){this.speed=0}}}};c.updateAngleToMouse=function(k){var m=k.pageX-this.cx;var j=k.pageY-this.cy;var g=Math.atan2(m,j);var h=g*(180/Math.PI*-1)+180;if(this.lastMouseAngle===undefined){this.lastElementAngle=this.virtualAngle;this.lastMouseAngle=h}if(this.stepTransitionTime!==d.stepTransitionTime){this.speed=this.mouseDiff=this.differenceBetweenAngles(h,this.lastMouseAngle);this.virtualAngle=this.lastElementAngle+this.mouseDiff;this.lastElementAngle=this.virtualAngle;this.lastMouseAngle=h}else{var i=this.virtualAngle;this.mouseDiff=h-this.lastMouseAngle;this.virtualAngle=this.lastElementAngle+this.mouseDiff;var l=this.virtualAngle;this.speed=this.differenceBetweenAngles(l,i)}};c.initCoordinates=function(){var g=this.getViewOffset();this.cx=g.x+(this.element.offsetWidth/2);this.cy=g.y+(this.element.offsetHeight/2)};c.initDrag=function(){this.speed=0;this.lastMouseAngle=undefined;this.lastElementAngle=undefined;this.lastMouseEvent=undefined};c.initOptions=function(g){g=g||d;this.touchElement=document.querySelectorAll(g.touchElement)[0]||this.element;this.onRotate=g.onRotate||g.onrotate;this.onStop=g.onStop||g.onstop;this.onDragStop=g.onDragStop||g.ondragstop;this.onDragStart=g.onDragStart||g.ondragstart;this.step=g.step||d.step;this.stepTransitionTime=g.stepTransitionTime||d.stepTransitionTime;this.stepTransitionEasing=g.stepTransitionEasing||d.stepTransitionEasing;this.angle=g.angle||d.angle;this.speed=g.speed||d.speed;this.inertia=g.inertia||d.inertia;this.minimalSpeed=g.minimalSpeed||d.minimalSpeed;this.lastAppliedAngle=this.virtualAngle=this._angle=g.angle||d.angle;this.minimalAngleChange=this.step!==d.step?this.step:d.minimalAngleChange;this.rotateParentInstantly=g.rotateParentInstantly||d.rotateParentInstantly};c.initCSSPrefix=function(){if(f.cssPrefix===undefined){if(typeof(document.body.style.transform)!="undefined"){f.cssPrefix=""}else{if(typeof(document.body.style.mozTransform)!="undefined"){f.cssPrefix="-moz-"}else{if(typeof(document.body.style.webkitTransform)!="undefined"){f.cssPrefix="-webkit-"}else{if(typeof(document.body.style.msTransform)!="undefined"){f.cssPrefix="-ms-"}}}}}};c.initHardwareAcceleration=function(){this.accelerationPostfix="";var j=document.createElement("p"),k,i={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(j,null);for(var h in i){if(j.style[h]!==undefined){j.style[h]="translate3d(1px,1px,1px)";k=window.getComputedStyle(j).getPropertyValue(i[h])}}document.body.removeChild(j);var g=(k!==undefined&&k.length>0&&k!=="none");if(g===true){this.accelerationPostfix="translateZ(0)";this.element.style[f.cssPrefix+"transform"]=this.accelerationPostfix;this.updateCSS()}};c.initTransition=function(){if(this.stepTransitionTime!==d.stepTransitionTime){var g="all "+this.stepTransitionTime+"ms "+this.stepTransitionEasing;this.element.style[f.cssPrefix+"transition"]=g}};c.updateCSS=function(){this.element.style[f.cssPrefix+"transform"]="rotate("+this._angle+"deg) "+this.accelerationPostfix};c.blockTransition=function(){if(this.stepTransitionTime!==d.stepTransitionTime){var g=this;setTimeout(function(){g.transiting=false},this.stepTransitionTime);this.transiting=true}};c.getViewOffset=function(g){var h={x:0,y:0};if(f.IEVersion!==false&&f.IEVersion<9){h.x=this.element.offsetLeft;h.y=this.element.offsetTop;return h}if(this.element){this.addOffset(this.element,h,"defaultView" in document?document.defaultView:document.parentWindow)}return h};c.addOffset=function(i,m,l){var h=i.offsetParent;m.x+=i.offsetLeft-(h?h.scrollLeft:0);m.y+=i.offsetTop-(h?h.scrollTop:0);if(h){if(h.nodeType==1){var o=l.getComputedStyle(h,"");if(o.position!="static"){m.x+=parseInt(o.borderLeftWidth);m.y+=parseInt(o.borderTopWidth);if(h.localName.toLowerCase()=="table"){m.x+=parseInt(o.paddingLeft);m.y+=parseInt(o.paddingTop)}else{if(h.localName.toLowerCase()=="body"){var g=l.getComputedStyle(i,"");m.x+=parseInt(g.marginLeft);m.y+=parseInt(g.marginTop)}}}else{if(h.localName.toLowerCase()=="body"){m.x+=parseInt(o.borderLeftWidth);m.y+=parseInt(o.borderTopWidth)}}var n=i.parentNode;while(h!=n){m.x-=n.scrollLeft;m.y-=n.scrollTop;n=n.parentNode}this.addOffset(h,m,l)}}else{if(i.localName.toLowerCase()=="body"){var g=l.getComputedStyle(i,"");m.x+=parseInt(g.borderLeftWidth);m.y+=parseInt(g.borderTopWidth);var j=l.getComputedStyle(i.parentNode,"");m.x+=parseInt(j.paddingLeft);m.y+=parseInt(j.paddingTop);m.x+=parseInt(j.marginLeft);m.y+=parseInt(j.marginTop)}if(i.scrollLeft){m.x+=i.scrollLeft}if(i.scrollTop){m.y+=i.scrollTop}var k=i.ownerDocument.defaultView;if(k&&(k.frameElement)){this.addOffset(k.frameElement,m,k)}}};c.returnFalse=function(){return false};if(a.$!==undefined){$.propeller={};$.propeller.propellers=[];$.fn[b]=function(g){return this.each(function(){if(!$.data(this,"plugin_"+b)){var h=new f(this,g);$.data(this,"plugin_"+b,h);$.propeller.propellers.push(h)}})}}var e=navigator.userAgent.toLowerCase();f.IEVersion=(e.indexOf("msie")!=-1)?parseInt(e.split("msie")[1]):false;f.deg2radians=Math.PI*2/360;a.Propeller=f})(window);window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1000/60)}})();if(!Function.prototype.bind){Function.prototype.bind=function(a){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")}var e=Array.prototype.slice.call(arguments,1),d=this,b=function(){},c=function(){return d.apply(this instanceof b&&a?this:a,e.concat(Array.prototype.slice.call(arguments)))};b.prototype=this.prototype;c.prototype=new b();return c}}(function(e,d){if(e.addEventListener){return}function a(g){var f=d[g];d[g]=function(h){return b(f(h))}}function c(f,h,g){return(g=this).attachEvent("on"+f,function(i){var i=i||e.event;i.preventDefault=i.preventDefault||function(){i.returnValue=false};i.stopPropagation=i.stopPropagation||function(){i.cancelBubble=true};h.call(g,i)})}function b(g,f){if(f=g.length){while(f--){g[f].addEventListener=c}}else{g.addEventListener=c}return g}b([d,e]);if("Element" in e){e.Element.prototype.addEventListener=c}else{d.attachEvent("onreadystatechange",function(){b(d.all)});a("getElementsByTagName");a("getElementById");a("createElement");b(d.all)}})(window,document);if(!window.getComputedStyle){window.getComputedStyle=function(a,b){this.el=a;this.getPropertyValue=function(d){var c=/(\-([a-z]){1})/g;if(d=="float"){d="styleFloat"}if(c.test(d)){d=d.replace(c,function(){return arguments[2].toUpperCase()})}return a.currentStyle[d]?a.currentStyle[d]:null};return this}}function getterSetter(b,c,a,d){if(Object.defineProperty){Object.defineProperty(b,c,{get:a,set:d})}else{if(document.__defineGetter__){b.__defineGetter__(c,a);b.__defineSetter__(c,d)}}};